/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 17:56:52][INFO] test_net.py: 168: Test with config:
[05/11 17:56:52][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [256, 320]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_try
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_try
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 17:56:52][INFO] uniformer2d_psnn_try.py: 585: Use checkpoint: False
[05/11 17:56:52][INFO] uniformer2d_psnn_try.py: 586: Checkpoint number: [0, 0, 0, 0]
[05/11 17:56:55][INFO] misc.py: 191: Model:
Uniformer2d_psnn_try(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 17:56:55][INFO] misc.py: 192: Params: 13,352,332
[05/11 17:56:55][INFO] misc.py: 193: Mem: 0.050076961517333984 MB
[05/11 17:56:57][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 17:56:57][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 17:56:57][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 17:56:57][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 8 time(s)
[05/11 17:56:57][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 17:56:57][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 17:56:57][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 17:56:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 17:56:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 17:56:58][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 17:56:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 17:56:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 8 time(s)
[05/11 17:56:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 17:56:58][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 17:56:58][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 17:56:58][INFO] misc.py: 210: nvidia-smi
Sat May 11 17:56:58 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   36C    P0    27W /  70W |   3414MiB / 15109MiB |     11%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 17:56:58][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.running_var not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights lpBN.weight not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights lpBN.bias not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights lpBN.running_mean not loaded.
[05/11 17:56:59][INFO] checkpoint.py: 336: Network weights lpBN.running_var not loaded.
[05/11 17:56:59][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 17:56:59][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 17:56:59][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 17:56:59][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 212, in test
    ts1 = time.time()
NameError: name 'time' is not defined

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 18:01:33][INFO] test_net.py: 168: Test with config:
[05/11 18:01:33][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [256, 320]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_try
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_try
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 18:01:33][INFO] uniformer2d_psnn_try.py: 585: Use checkpoint: False
[05/11 18:01:33][INFO] uniformer2d_psnn_try.py: 586: Checkpoint number: [0, 0, 0, 0]
[05/11 18:01:36][INFO] misc.py: 191: Model:
Uniformer2d_psnn_try(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, step_mode=m)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 18:01:36][INFO] misc.py: 192: Params: 13,352,332
[05/11 18:01:36][INFO] misc.py: 193: Mem: 0.050076961517333984 MB
[05/11 18:01:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:01:38][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:01:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:01:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 8 time(s)
[05/11 18:01:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:01:38][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:01:38][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 18:01:39][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 18:01:39][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:01:39][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:01:39][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:01:39][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 8 time(s)
[05/11 18:01:39][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:01:39][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:01:39][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 18:01:39][INFO] misc.py: 210: nvidia-smi
Sat May 11 18:01:39 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   36C    P0    27W /  70W |   3414MiB / 15109MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 18:01:39][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed1.norm.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks1.0.mlp.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed2.norm.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks2.0.mlp.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed3.norm.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.attn.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.0.mlp.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.attn.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.1.mlp.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.attn.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks3.2.mlp.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights patch_embed4.norm.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.attn.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm1.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights blocks4.0.mlp.norm2.running_var not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights lpBN.weight not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights lpBN.bias not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights lpBN.running_mean not loaded.
[05/11 18:01:39][INFO] checkpoint.py: 336: Network weights lpBN.running_var not loaded.
[05/11 18:01:39][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 18:01:39][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 18:01:39][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 18:01:39][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 214, in test
    import energy_consumption_calculation
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/__init__.py", line 1, in <module>
    from .flops_counter import get_model_complexity_info
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 13, in <module>
    from .engine import get_syops_pytorch
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 16, in <module>
    from progress.bar import Bar as Bar
ModuleNotFoundError: No module named 'progress'

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 18:05:45][INFO] test_net.py: 168: Test with config:
[05/11 18:05:45][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 18:05:45][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 18:05:45][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 18:05:48][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 18:05:48][INFO] misc.py: 192: Params: 13,801,612
[05/11 18:05:48][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 18:05:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:05:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:05:50][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:05:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:05:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:05:50][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:05:51][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 18:05:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:05:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 18:05:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:05:51][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:05:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:05:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:05:51][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:05:51][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 18:05:51][INFO] misc.py: 210: nvidia-smi
Sat May 11 18:05:51 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   36C    P0    27W /  70W |   3420MiB / 15109MiB |     15%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 18:05:51][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 18:05:51][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 18:05:51][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 18:05:51][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 18:05:51][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/ops.py", line 13, in <module>
    from spikingjelly.clock_driven.neuron import MultiStepIFNode, MultiStepLIFNode, IFNode, LIFNode, MultiStepParametricLIFNode, ParametricLIFNode
ModuleNotFoundError: No module named 'spikingjelly.clock_driven'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 214, in test
    import energy_consumption_calculation
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/__init__.py", line 1, in <module>
    from .flops_counter import get_model_complexity_info
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 13, in <module>
    from .engine import get_syops_pytorch
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 22, in <module>
    from .ops import CUSTOM_MODULES_MAPPING, MODULES_MAPPING
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/ops.py", line 15, in <module>
    from spikingjelly.activation_based.neuron import MultiStepIFNode, MultiStepLIFNode, IFNode, LIFNode, MultiStepParametricLIFNode, ParametricLIFNode
ImportError: cannot import name 'MultiStepIFNode' from 'spikingjelly.activation_based.neuron' (/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/neuron.py)

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 18:08:08][INFO] test_net.py: 168: Test with config:
[05/11 18:08:08][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 18:08:08][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 18:08:08][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 18:08:11][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 18:08:11][INFO] misc.py: 192: Params: 13,801,612
[05/11 18:08:11][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 18:08:13][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:08:13][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:08:13][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:08:13][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:08:13][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:08:13][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:08:13][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 18:08:14][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:08:14][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 18:08:14][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:08:14][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:08:14][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:08:14][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:08:14][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:08:14][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 18:08:14][INFO] misc.py: 210: nvidia-smi
Sat May 11 18:08:14 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   36C    P0    27W /  70W |   3420MiB / 15109MiB |     14%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 18:08:14][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 18:08:14][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 18:08:14][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 18:08:14][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 18:08:14][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 214, in test
    import energy_consumption_calculation
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/__init__.py", line 1, in <module>
    from .flops_counter import get_model_complexity_info
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 13, in <module>
    from .engine import get_syops_pytorch
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 22, in <module>
    from .ops import CUSTOM_MODULES_MAPPING, MODULES_MAPPING
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/ops.py", line 379, in <module>
    MultiStepIFNode: IF_syops_counter_hook,
NameError: name 'MultiStepIFNode' is not defined

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 18:09:25][INFO] test_net.py: 168: Test with config:
[05/11 18:09:25][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 18:09:25][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 18:09:25][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 18:09:28][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 18:09:28][INFO] misc.py: 192: Params: 13,801,612
[05/11 18:09:28][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 18:09:30][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:09:30][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:09:30][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:09:30][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:09:30][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:09:30][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:09:30][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 18:09:31][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:09:31][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 18:09:31][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:09:31][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:09:31][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:09:31][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:09:31][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:09:31][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 18:09:31][INFO] misc.py: 210: nvidia-smi
Sat May 11 18:09:31 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   36C    P0    27W /  70W |   3420MiB / 15109MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 18:09:31][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 18:09:31][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 18:09:31][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 18:09:31][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 18:09:31][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
Warning: module Conv2d is treated as a zero-op.
Warning: module BatchNorm2d_eT is treated as a zero-op.
Warning: module SpeicalPatchEmbed is treated as a zero-op.
Warning: module Dropout is treated as a zero-op.
Warning: module ATan is treated as a zero-op.
Warning: module Identity is treated as a zero-op.
Warning: module CMlp is treated as a zero-op.
Warning: module CBlock is treated as a zero-op.
Warning: module PatchEmbed is treated as a zero-op.
Warning: module Linear is treated as a zero-op.
Warning: module BatchNorm1d_eT is treated as a zero-op.
Warning: module Attention is treated as a zero-op.
Warning: module Mlp is treated as a zero-op.
Warning: module SABlock is treated as a zero-op.
Warning: module Uniformer2d_psnn_lgf is treated as a zero-op.
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/opt/conda/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/opt/conda/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/opt/conda/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/opt/conda/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
ConnectionRefusedError: [Errno 111] Connection refused
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 217, in test
    Nops, Nparams = get_model_complexity_info(model, (3, 224, 224), test_loader, as_strings=True, print_per_layer_stat=True, verbose=True, syops_units='Mac', param_units=' ', output_precision=3)
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 116, in get_model_complexity_info
    syops_count, params_count, syops_model = get_syops_pytorch(model, input_res, dataloader,
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 50, in get_syops_pytorch
    for batch, target in dataloader:
ValueError: too many values to unpack (expected 2)

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 18:11:58][INFO] test_net.py: 168: Test with config:
[05/11 18:11:58][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 18:11:58][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 18:11:58][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 18:12:01][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 18:12:01][INFO] misc.py: 192: Params: 13,801,612
[05/11 18:12:01][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 18:12:03][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:12:03][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:12:03][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:12:03][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:12:03][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:12:03][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:12:03][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 18:12:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:12:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 18:12:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:12:04][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:12:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:12:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:12:04][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:12:04][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 18:12:04][INFO] misc.py: 210: nvidia-smi
Sat May 11 18:12:04 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   36C    P0    27W /  70W |   3420MiB / 15109MiB |     13%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 18:12:04][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 18:12:04][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 18:12:04][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 18:12:04][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 18:12:04][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
Warning: module Conv2d is treated as a zero-op.
Warning: module BatchNorm2d_eT is treated as a zero-op.
Warning: module SpeicalPatchEmbed is treated as a zero-op.
Warning: module Dropout is treated as a zero-op.
Warning: module ATan is treated as a zero-op.
Warning: module Identity is treated as a zero-op.
Warning: module CMlp is treated as a zero-op.
Warning: module CBlock is treated as a zero-op.
Warning: module PatchEmbed is treated as a zero-op.
Warning: module Linear is treated as a zero-op.
Warning: module BatchNorm1d_eT is treated as a zero-op.
Warning: module Attention is treated as a zero-op.
Warning: module Mlp is treated as a zero-op.
Warning: module SABlock is treated as a zero-op.
Warning: module Uniformer2d_psnn_lgf is treated as a zero-op.
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/opt/conda/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/opt/conda/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/opt/conda/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/opt/conda/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
ConnectionRefusedError: [Errno 111] Connection refused
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 217, in test
    Nops, Nparams = get_model_complexity_info(model, (3, 224, 224), test_loader, as_strings=True, print_per_layer_stat=True, verbose=True, syops_units='Mac', param_units=' ', output_precision=3)
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 116, in get_model_complexity_info
    syops_count, params_count, syops_model = get_syops_pytorch(model, input_res, dataloader,
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 55, in get_syops_pytorch
    batch = batch.float().to(next(syops_model.parameters()).device)  # torch.Size([128, 3, 32, 32])
AttributeError: 'list' object has no attribute 'float'

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 18:17:26][INFO] test_net.py: 168: Test with config:
[05/11 18:17:26][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 18:17:26][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 18:17:26][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 18:17:29][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 18:17:29][INFO] misc.py: 192: Params: 13,801,612
[05/11 18:17:29][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:17:32][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 18:17:32][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 18:17:32][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 18:17:32][INFO] misc.py: 210: nvidia-smi
Sat May 11 18:17:32 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   36C    P0    27W /  70W |   3420MiB / 15109MiB |     13%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 18:17:32][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 18:17:32][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 18:17:32][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 18:17:32][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 18:17:32][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
Warning: module Conv2d is treated as a zero-op.
Warning: module BatchNorm2d_eT is treated as a zero-op.
Warning: module SpeicalPatchEmbed is treated as a zero-op.
Warning: module Dropout is treated as a zero-op.
Warning: module ATan is treated as a zero-op.
Warning: module Identity is treated as a zero-op.
Warning: module CMlp is treated as a zero-op.
Warning: module CBlock is treated as a zero-op.
Warning: module PatchEmbed is treated as a zero-op.
Warning: module Linear is treated as a zero-op.
Warning: module BatchNorm1d_eT is treated as a zero-op.
Warning: module Attention is treated as a zero-op.
Warning: module Mlp is treated as a zero-op.
Warning: module SABlock is treated as a zero-op.
Warning: module Uniformer2d_psnn_lgf is treated as a zero-op.
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
2 0.16674333810806274 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.15526320040225983 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.155488982796669 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.17932841181755066 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.1187712773680687 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.12619592249393463 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.07670332491397858 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.06328573077917099 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05655296519398689 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.06590966135263443 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.09176433086395264 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.08029055595397949 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11043693870306015 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.2110837996006012 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.14748620986938477 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02591526135802269 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.0603797547519207 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11706122010946274 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.10042271018028259 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.08531017601490021 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.22485299408435822 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11026732623577118 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.04093097522854805 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.08387024700641632 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.2226768434047699 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.09224902838468552 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11617527902126312 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.34831875562667847 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.04782384634017944 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05051414296030998 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02395007014274597 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05397640913724899 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.13592560589313507 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.07932016998529434 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.07223697751760483 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.048486512154340744 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.037361301481723785 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02173614501953125 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.03956969827413559 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.03956969827413559 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
16355 1 tensor(37.5135, device='cuda:0')
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d()
    (norm): BatchNorm2d_eT()
  )
  (pos_drop): Dropout()
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5784944295883179, 1, 0.000% Params, 6422528.0 Ops, 7.547% oriMACs, 6422528.0 Ops, 7.686% ACs, 0.0 Ops, 0.000% MACs, 16.674% Spike Rate, SpkStat: None
        (surrogate_function): ATan()
      )
      (conv1): Conv2d()
      (attn): Conv2d()
      (conv2): Conv2d()
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT()
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.9701817035675049, 1, 0.000% Params, 6422528.0 Ops, 7.547% oriMACs, 6422528.0 Ops, 7.686% ACs, 0.0 Ops, 0.000% MACs, 15.526% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Conv2d()
        (norm1): BatchNorm2d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.538673162460327, 1, 0.000% Params, 12845056.0 Ops, 15.094% oriMACs, 12845056.0 Ops, 15.373% ACs, 0.0 Ops, 0.000% MACs, 15.549% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Conv2d()
        (norm2): BatchNorm2d_eT()
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.2462283372879028, 1, 0.000% Params, 6422528.0 Ops, 7.547% oriMACs, 6422528.0 Ops, 7.686% ACs, 0.0 Ops, 0.000% MACs, 17.933% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d()
    (norm): BatchNorm2d_eT()
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.169824481010437, 1, 0.000% Params, 3211264.0 Ops, 3.773% oriMACs, 3211264.0 Ops, 3.843% ACs, 0.0 Ops, 0.000% MACs, 11.877% Spike Rate, SpkStat: None
        (surrogate_function): ATan()
      )
      (conv1): Conv2d()
      (attn): Conv2d()
      (conv2): Conv2d()
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT()
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.0328818559646606, 1, 0.000% Params, 3211264.0 Ops, 3.773% oriMACs, 3211264.0 Ops, 3.843% ACs, 0.0 Ops, 0.000% MACs, 12.620% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Conv2d()
        (norm1): BatchNorm2d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.697751522064209, 1, 0.000% Params, 6422528.0 Ops, 7.547% oriMACs, 6422528.0 Ops, 7.686% ACs, 0.0 Ops, 0.000% MACs, 7.670% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Conv2d()
        (norm2): BatchNorm2d_eT()
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5027964115142822, 1, 0.000% Params, 3211264.0 Ops, 3.773% oriMACs, 3211264.0 Ops, 3.843% ACs, 0.0 Ops, 0.000% MACs, 6.329% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d()
    (norm): BatchNorm2d_eT()
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.51208233833313, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 6.591% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear()
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0040385723114014, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 9.176% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.321223735809326, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 8.029% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.1636204719543457, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 11.044% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.178424835205078, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 21.108% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear()
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.0380210876464844, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 14.749% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear()
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0244860649108887, 1, 0.000% Params, 2408448.0 Ops, 2.830% oriMACs, 2408448.0 Ops, 2.882% ACs, 0.0 Ops, 0.000% MACs, 2.592% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear()
        (norm2): BatchNorm1d_eT()
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.622936248779297, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 6.038% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear()
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.214975357055664, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 11.706% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.039510726928711, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 10.042% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.3648018836975098, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 8.531% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.9816348552703857, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 22.485% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear()
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5850307941436768, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 11.027% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear()
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5154521465301514, 1, 0.000% Params, 2408448.0 Ops, 2.830% oriMACs, 2408448.0 Ops, 2.882% ACs, 0.0 Ops, 0.000% MACs, 4.093% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear()
        (norm2): BatchNorm1d_eT()
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.248232364654541, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 8.387% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear()
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.153169631958008, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 22.268% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.14504337310791, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 9.225% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.923473596572876, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 11.618% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.229710578918457, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 34.832% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear()
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.4227283000946045, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 4.782% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear()
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.283605575561523, 1, 0.000% Params, 2408448.0 Ops, 2.830% oriMACs, 2408448.0 Ops, 2.882% ACs, 0.0 Ops, 0.000% MACs, 5.051% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear()
        (norm2): BatchNorm1d_eT()
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.373702049255371, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 2.395% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d()
    (norm): BatchNorm2d_eT()
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.571432113647461, 1, 0.000% Params, 401408.0 Ops, 0.472% oriMACs, 401408.0 Ops, 0.480% ACs, 0.0 Ops, 0.000% MACs, 5.398% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear()
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.8827295303344727, 1, 0.000% Params, 401408.0 Ops, 0.472% oriMACs, 401408.0 Ops, 0.480% ACs, 0.0 Ops, 0.000% MACs, 13.593% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.1508498191833496, 1, 0.000% Params, 401408.0 Ops, 0.472% oriMACs, 401408.0 Ops, 0.480% ACs, 0.0 Ops, 0.000% MACs, 7.932% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.235987663269043, 1, 0.000% Params, 401408.0 Ops, 0.472% oriMACs, 401408.0 Ops, 0.480% ACs, 0.0 Ops, 0.000% MACs, 7.224% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0004072189331055, 1, 0.000% Params, 401408.0 Ops, 0.472% oriMACs, 401408.0 Ops, 0.480% ACs, 0.0 Ops, 0.000% MACs, 4.849% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear()
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.3670759201049805, 1, 0.000% Params, 401408.0 Ops, 0.472% oriMACs, 401408.0 Ops, 0.480% ACs, 0.0 Ops, 0.000% MACs, 3.736% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear()
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.4031219482421875, 1, 0.000% Params, 802816.0 Ops, 0.943% oriMACs, 802816.0 Ops, 0.961% ACs, 0.0 Ops, 0.000% MACs, 2.174% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear()
        (norm2): BatchNorm1d_eT()
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.864428997039795, 1, 0.000% Params, 1204224.0 Ops, 1.415% oriMACs, 1204224.0 Ops, 1.441% ACs, 0.0 Ops, 0.000% MACs, 5.655% Spike Rate, SpkStat: None
    (surrogate_function): ATan()
  )
  (lpDWConv): Conv2d()
  (lpPWConv): Conv2d()
  (lpBN): BatchNorm2d_eT()
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.526439666748047, 1, 0.000% Params, 802816.0 Ops, 0.943% oriMACs, 802816.0 Ops, 0.961% ACs, 0.0 Ops, 0.000% MACs, 3.957% Spike Rate, SpkStat: None
    (surrogate_function): ATan()
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512, 1606656, 11.641% Params, 1606656.0 Ops, 1.888% oriMACs, 63574.89315032959 Ops, 0.076% ACs, 0.0 Ops, 0.000% MACs, 3.957% Spike Rate, SpkStat: None)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, 2048, 0.015% Params, 2048.0 Ops, 0.002% oriMACs, 0.0 Ops, 0.000% ACs, 2048.0 Ops, 100.000% MACs, 100.000% Spike Rate, SpkStat: None)
  (head): Linear()
)Exception in thread Thread-2:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/opt/conda/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/opt/conda/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/opt/conda/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/opt/conda/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 508, in Client
    answer_challenge(c, authkey)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 757, in answer_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/opt/conda/lib/python3.8/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer

Nops:  ['85101568.0 Ops', '83556438.89315033 Ops', '2048.0 Ops']
Nparams:  13801612
Time cost: 0.5377965132395427 min
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 19:15:37][INFO] test_net.py: 168: Test with config:
[05/11 19:15:37][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 19:15:37][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 19:15:37][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 19:15:40][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 19:15:40][INFO] misc.py: 192: Params: 13,801,612
[05/11 19:15:40][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 19:15:42][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:15:42][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:15:42][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:15:42][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:15:42][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:15:42][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:15:42][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 19:15:43][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:15:43][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 19:15:43][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:15:43][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:15:43][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:15:43][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:15:43][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:15:43][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 19:15:43][INFO] misc.py: 210: nvidia-smi
Sat May 11 19:15:43 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   37C    P0    27W /  70W |   3420MiB / 15109MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 19:15:43][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 19:15:43][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 19:15:43][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 19:15:43][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 19:15:43][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 214, in test
    import energy_consumption_calculation
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/__init__.py", line 1, in <module>
    from .flops_counter import get_model_complexity_info
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 13, in <module>
    from .engine import get_syops_pytorch
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 22, in <module>
    from .ops import CUSTOM_MODULES_MAPPING, MODULES_MAPPING
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/ops.py", line 19
    from ../../slowfast/models/uniformer2d_psnn_lgf import BatchNorm1d_eT, BatchNorm2d_eT
           ^
SyntaxError: invalid syntax

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 19:17:04][INFO] test_net.py: 168: Test with config:
[05/11 19:17:04][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 19:17:04][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 19:17:04][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 19:17:07][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 19:17:07][INFO] misc.py: 192: Params: 13,801,612
[05/11 19:17:07][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 19:17:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:17:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:17:09][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:17:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:17:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:17:09][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:17:09][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 19:17:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:17:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 19:17:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:17:10][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:17:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:17:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:17:10][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:17:10][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 19:17:10][INFO] misc.py: 210: nvidia-smi
Sat May 11 19:17:10 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   37C    P0    27W /  70W |   3420MiB / 15109MiB |      5%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 19:17:10][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 19:17:10][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 19:17:10][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 19:17:10][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 19:17:10][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 214, in test
    import energy_consumption_calculation
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/__init__.py", line 1, in <module>
    from .flops_counter import get_model_complexity_info
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 13, in <module>
    from .engine import get_syops_pytorch
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 22, in <module>
    from .ops import CUSTOM_MODULES_MAPPING, MODULES_MAPPING
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/ops.py", line 19, in <module>
    from uniformer2d_psnn_lgf import BatchNorm1d_eT, BatchNorm2d_eT
  File "/userhome/transformer/UniFormer/video_classification/tools/uniformer2d_psnn_lgf.py", line 11, in <module>
    from .build import MODEL_REGISTRY
ImportError: attempted relative import with no known parent package

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 19:20:55][INFO] test_net.py: 168: Test with config:
[05/11 19:20:55][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 19:20:55][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 19:20:55][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 19:20:58][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 19:20:58][INFO] misc.py: 192: Params: 13,801,612
[05/11 19:20:58][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 19:21:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:21:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:21:01][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:21:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:21:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:21:01][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:21:01][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 19:21:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:21:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 19:21:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:21:02][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:21:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:21:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:21:02][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:21:02][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 19:21:02][INFO] misc.py: 210: nvidia-smi
Sat May 11 19:21:02 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   37C    P0    27W /  70W |   3420MiB / 15109MiB |     12%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 19:21:02][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 19:21:02][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 19:21:02][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 19:21:02][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 19:21:02][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
Traceback (most recent call last):
  File "tools/run_net.py", line 31, in <module>
    main()
  File "tools/run_net.py", line 27, in main
    launch_job(cfg=cfg, init_method=args.init_method, func=test)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/misc.py", line 312, in launch_job
    torch.multiprocessing.spawn(
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/userhome/transformer/UniFormer/video_classification/slowfast/utils/multiprocessing.py", line 60, in run
    ret = func(cfg)
  File "/userhome/transformer/UniFormer/video_classification/tools/test_net.py", line 214, in test
    import energy_consumption_calculation
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/__init__.py", line 1, in <module>
    from .flops_counter import get_model_complexity_info
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/flops_counter.py", line 13, in <module>
    from .engine import get_syops_pytorch
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/engine.py", line 22, in <module>
    from .ops import CUSTOM_MODULES_MAPPING, MODULES_MAPPING
  File "/userhome/transformer/UniFormer/video_classification/tools/energy_consumption_calculation/ops.py", line 19, in <module>
    from tdbn import BatchNorm1d_eT, BatchNorm2d_eT
  File "/userhome/transformer/UniFormer/video_classification/tools/tdbn.py", line 3, in <module>
    class BatchNorm1d_eT(nn.BatchNorm1d):
  File "/userhome/transformer/UniFormer/video_classification/tools/tdbn.py", line 21, in BatchNorm1d_eT
    def forward(self, x: Tensor):
NameError: name 'Tensor' is not defined

/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 19:22:12][INFO] test_net.py: 168: Test with config:
[05/11 19:22:12][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 19:22:12][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 19:22:12][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 19:22:15][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 19:22:15][INFO] misc.py: 192: Params: 13,801,612
[05/11 19:22:15][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:22:18][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:22:18][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:22:18][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 19:22:18][INFO] misc.py: 210: nvidia-smi
Sat May 11 19:22:18 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   37C    P0    27W /  70W |   3420MiB / 15109MiB |      6%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 19:22:18][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 19:22:18][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 19:22:18][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 19:22:18][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 19:22:19][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
Warning: module BatchNorm2d_eT is treated as a zero-op.
Warning: module SpeicalPatchEmbed is treated as a zero-op.
Warning: module Dropout is treated as a zero-op.
Warning: module ATan is treated as a zero-op.
Warning: module Identity is treated as a zero-op.
Warning: module CMlp is treated as a zero-op.
Warning: module CBlock is treated as a zero-op.
Warning: module PatchEmbed is treated as a zero-op.
Warning: module BatchNorm1d_eT is treated as a zero-op.
Warning: module Attention is treated as a zero-op.
Warning: module Mlp is treated as a zero-op.
Warning: module SABlock is treated as a zero-op.
Warning: module Uniformer2d_psnn_lgf is treated as a zero-op.
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
15843880 1 tensor(2.4444, device='cuda:0')
2 0.16674333810806274 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.16674333810806274 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
56557978 1 tensor(4.6114, device='cuda:0')
51069984 1 tensor(6.8119, device='cuda:0')
2 0.15526320040225983 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.15526320040225983 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.155488982796669 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.155488982796669 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.17932841181755066 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.17932841181755066 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.1187712773680687 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.1187712773680687 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
37960140 1 tensor(8.1138, device='cuda:0')
37001603 1 tensor(9.7372, device='cuda:0')
2 0.12619592249393463 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.12619592249393463 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.07670332491397858 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.07670332491397858 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.06328573077917099 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.06328573077917099 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05655296519398689 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05655296519398689 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
93944 1 tensor(3.4738, device='cuda:0')
2 0.06590966135263443 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.06590966135263443 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.09176433086395264 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.08029055595397949 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11043693870306015 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.2110837996006012 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.2110837996006012 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.14748620986938477 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.14748620986938477 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02591526135802269 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02591526135802269 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.0603797547519207 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.0603797547519207 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11706122010946274 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.10042271018028259 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.08531017601490021 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.22485299408435822 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.22485299408435822 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11026732623577118 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11026732623577118 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.04093097522854805 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.04093097522854805 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.08387024700641632 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.08387024700641632 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.2226768434047699 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.09224902838468552 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.11617527902126312 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.34831875562667847 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.34831875562667847 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.04782384634017944 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.04782384634017944 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05051414296030998 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05051414296030998 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02395007014274597 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02395007014274597 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05397640913724899 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.05397640913724899 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.13592560589313507 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.07932016998529434 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.07223697751760483 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.048486512154340744 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.048486512154340744 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.037361301481723785 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.037361301481723785 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02173614501953125 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.02173614501953125 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.03956969827413559 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
2 0.03956969827413559 tensor([0., 1.], device='cuda:0') tensor([0., 1.], device='cuda:0')
16355 1 tensor(37.5135, device='cuda:0')
16358 1 tensor(1.4977, device='cuda:0')
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m, 13952, 0.101% Params, 5600444416.0 Ops, 1.149% oriMACs, 0.0 Ops, 0.000% ACs, 5600444416.0 Ops, 16.945% MACs, 100.000% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (pos_drop): Dropout()
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5784944295883179, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 16.674% Spike Rate, SpkStat: None
        (surrogate_function): ATan()
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 16512, 0.120% Params, 6628048896.0 Ops, 1.360% oriMACs, 1105182998.0625 Ops, 2.352% ACs, 0.0 Ops, 0.000% MACs, 16.674% Spike Rate, SpkStat: None)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m, 3328, 0.024% Params, 1335885824.0 Ops, 0.274% oriMACs, 0.0 Ops, 0.000% ACs, 1335885824.0 Ops, 4.042% MACs, 100.000% Spike Rate, SpkStat: None)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 16512, 0.120% Params, 6628048896.0 Ops, 1.360% oriMACs, 0.0 Ops, 0.000% ACs, 6628048896.0 Ops, 20.054% MACs, 100.000% Spike Rate, SpkStat: None)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT()
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.9701817035675049, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 15.526% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 33024, 0.239% Params, 26512195584.0 Ops, 5.441% oriMACs, 4116368336.0625 Ops, 8.759% ACs, 0.0 Ops, 0.000% MACs, 15.526% Spike Rate, SpkStat: None)
        (norm1): BatchNorm2d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.538673162460327, 1, 0.000% Params, 12845056.0 Ops, 0.003% oriMACs, 12845056.0 Ops, 0.027% ACs, 0.0 Ops, 0.000% MACs, 15.549% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 32896, 0.238% Params, 13204717568.0 Ops, 2.710% oriMACs, 2053188102.765625 Ops, 4.369% ACs, 0.0 Ops, 0.000% MACs, 15.549% Spike Rate, SpkStat: None)
        (norm2): BatchNorm2d_eT()
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.2462283372879028, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 17.933% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m, 524544, 3.801% Params, 105278078976.0 Ops, 21.605% oriMACs, 18879350701.96875 Ops, 40.174% ACs, 0.0 Ops, 0.000% MACs, 17.933% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.169824481010437, 1, 0.000% Params, 3211264.0 Ops, 0.001% oriMACs, 3211264.0 Ops, 0.007% ACs, 0.0 Ops, 0.000% MACs, 11.877% Spike Rate, SpkStat: None
        (surrogate_function): ATan()
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 65792, 0.477% Params, 13204717568.0 Ops, 2.710% oriMACs, 1568341172.8359375 Ops, 3.337% ACs, 0.0 Ops, 0.000% MACs, 11.877% Spike Rate, SpkStat: None)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m, 6656, 0.048% Params, 1335885824.0 Ops, 0.274% oriMACs, 0.0 Ops, 0.000% ACs, 1335885824.0 Ops, 4.042% MACs, 100.000% Spike Rate, SpkStat: None)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 65792, 0.477% Params, 13204717568.0 Ops, 2.710% oriMACs, 0.0 Ops, 0.000% ACs, 13204717568.0 Ops, 39.953% MACs, 100.000% Spike Rate, SpkStat: None)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT()
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.0328818559646606, 1, 0.000% Params, 3211264.0 Ops, 0.001% oriMACs, 3211264.0 Ops, 0.007% ACs, 0.0 Ops, 0.000% MACs, 12.620% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 131584, 0.953% Params, 52818870272.0 Ops, 10.839% oriMACs, 6665526059.0625 Ops, 14.184% ACs, 0.0 Ops, 0.000% MACs, 12.620% Spike Rate, SpkStat: None)
        (norm1): BatchNorm2d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.697751522064209, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 7.670% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 131328, 0.952% Params, 26358054912.0 Ops, 5.409% oriMACs, 2021750450.015625 Ops, 4.302% ACs, 0.0 Ops, 0.000% MACs, 7.670% Spike Rate, SpkStat: None)
        (norm2): BatchNorm2d_eT()
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5027964115142822, 1, 0.000% Params, 3211264.0 Ops, 0.001% oriMACs, 3211264.0 Ops, 0.007% ACs, 0.0 Ops, 0.000% MACs, 6.329% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m, 1573248, 11.399% Params, 118408937472.0 Ops, 24.299% oriMACs, 7493596138.700684 Ops, 15.946% ACs, 0.0 Ops, 0.000% MACs, 6.329% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.51208233833313, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 6.591% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True, 443520, 3.214% Params, 1387267200.0 Ops, 0.285% oriMACs, 91434311.35761738 Ops, 0.195% ACs, 0.0 Ops, 0.000% MACs, 6.591% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0040385723114014, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 9.176% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.321223735809326, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 8.029% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.1636204719543457, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 11.044% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.178424835205078, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 21.108% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=384, out_features=384, bias=True, 147840, 1.071% Params, 462422400.0 Ops, 0.095% oriMACs, 97609877.21242905 Ops, 0.208% ACs, 0.0 Ops, 0.000% MACs, 21.108% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.0380210876464844, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 14.749% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True, 295680, 2.142% Params, 924844800.0 Ops, 0.190% oriMACs, 136401854.26940918 Ops, 0.290% ACs, 0.0 Ops, 0.000% MACs, 14.749% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0244860649108887, 1, 0.000% Params, 2408448.0 Ops, 0.000% oriMACs, 2408448.0 Ops, 0.005% ACs, 0.0 Ops, 0.000% MACs, 2.592% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True, 295296, 2.140% Params, 924844416.0 Ops, 0.190% oriMACs, 23967584.75614786 Ops, 0.051% ACs, 0.0 Ops, 0.000% MACs, 2.592% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.622936248779297, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 6.038% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True, 443520, 3.214% Params, 1387267200.0 Ops, 0.285% oriMACs, 83762853.31138372 Ops, 0.178% ACs, 0.0 Ops, 0.000% MACs, 6.038% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.214975357055664, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 11.706% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.039510726928711, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 10.042% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.3648018836975098, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 8.531% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.9816348552703857, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 22.485% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=384, out_features=384, bias=True, 147840, 1.071% Params, 462422400.0 Ops, 0.095% oriMACs, 103977061.17167473 Ops, 0.221% ACs, 0.0 Ops, 0.000% MACs, 22.485% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5850307941436768, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 11.027% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True, 295680, 2.142% Params, 924844800.0 Ops, 0.190% oriMACs, 101980163.27905655 Ops, 0.217% ACs, 0.0 Ops, 0.000% MACs, 11.027% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5154521465301514, 1, 0.000% Params, 2408448.0 Ops, 0.000% oriMACs, 2408448.0 Ops, 0.005% ACs, 0.0 Ops, 0.000% MACs, 4.093% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True, 295296, 2.140% Params, 924844416.0 Ops, 0.190% oriMACs, 37854783.88155699 Ops, 0.081% ACs, 0.0 Ops, 0.000% MACs, 4.093% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.248232364654541, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 8.387% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True, 443520, 3.214% Params, 1387267200.0 Ops, 0.285% oriMACs, 116350442.72789955 Ops, 0.248% ACs, 0.0 Ops, 0.000% MACs, 8.387% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.153169631958008, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 22.268% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.14504337310791, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 9.225% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.923473596572876, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 11.618% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.229710578918457, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 34.832% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=384, out_features=384, bias=True, 147840, 1.071% Params, 462422400.0 Ops, 0.095% oriMACs, 161070394.94190216 Ops, 0.343% ACs, 0.0 Ops, 0.000% MACs, 34.832% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.4227283000946045, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 4.782% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True, 295680, 2.142% Params, 924844800.0 Ops, 0.190% oriMACs, 44229635.60371399 Ops, 0.094% ACs, 0.0 Ops, 0.000% MACs, 4.782% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.283605575561523, 1, 0.000% Params, 2408448.0 Ops, 0.000% oriMACs, 2408448.0 Ops, 0.005% ACs, 0.0 Ops, 0.000% MACs, 5.051% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True, 295296, 2.140% Params, 924844416.0 Ops, 0.190% oriMACs, 46717723.0458684 Ops, 0.099% ACs, 0.0 Ops, 0.000% MACs, 5.051% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.373702049255371, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 2.395% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m, 3146240, 22.796% Params, 78932869120.0 Ops, 16.198% oriMACs, 1890447751.9921875 Ops, 4.023% ACs, 0.0 Ops, 0.000% MACs, 2.395% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.571432113647461, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 5.398% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True, 787968, 5.709% Params, 616564224.0 Ops, 0.127% oriMACs, 33279922.814014435 Ops, 0.071% ACs, 0.0 Ops, 0.000% MACs, 5.398% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.8827295303344727, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 13.593% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.1508498191833496, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 7.932% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.235987663269043, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 7.224% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0004072189331055, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 4.849% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=512, out_features=512, bias=True, 262656, 1.903% Params, 205521408.0 Ops, 0.042% oriMACs, 9965016.246969223 Ops, 0.021% ACs, 0.0 Ops, 0.000% MACs, 4.849% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.3670759201049805, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 3.736% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True, 525312, 3.806% Params, 411042816.0 Ops, 0.084% oriMACs, 15357094.570472717 Ops, 0.033% ACs, 0.0 Ops, 0.000% MACs, 3.736% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.4031219482421875, 1, 0.000% Params, 802816.0 Ops, 0.000% oriMACs, 802816.0 Ops, 0.002% ACs, 0.0 Ops, 0.000% MACs, 2.174% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True, 524800, 3.802% Params, 411042304.0 Ops, 0.084% oriMACs, 8934475.12890625 Ops, 0.019% ACs, 0.0 Ops, 0.000% MACs, 2.174% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.864428997039795, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 5.655% Spike Rate, SpkStat: None
    (surrogate_function): ATan()
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m, 3840, 0.028% Params, 72253440.0 Ops, 0.015% oriMACs, 4086146.2774658203 Ops, 0.009% ACs, 0.0 Ops, 0.000% MACs, 5.655% Spike Rate, SpkStat: None)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 197120, 1.428% Params, 4945346560.0 Ops, 1.015% oriMACs, 0.0 Ops, 0.000% ACs, 4945346560.0 Ops, 14.963% MACs, 100.000% Spike Rate, SpkStat: None)
  (lpBN): BatchNorm2d_eT()
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.526439666748047, 1, 0.000% Params, 802816.0 Ops, 0.000% oriMACs, 802816.0 Ops, 0.002% ACs, 0.0 Ops, 0.000% MACs, 3.957% Spike Rate, SpkStat: None
    (surrogate_function): ATan()
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512, 1606656, 11.641% Params, 1606656.0 Ops, 0.000% oriMACs, 63574.89315032959 Ops, 0.000% ACs, 0.0 Ops, 0.000% MACs, 3.957% Spike Rate, SpkStat: None)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, 2048, 0.015% Params, 2048.0 Ops, 0.000% oriMACs, 0.0 Ops, 0.000% ACs, 2048.0 Ops, 0.000% MACs, 100.000% Spike Rate, SpkStat: None)
  (head): Linear(in_features=1024, out_features=101, bias=True, 103525, 0.750% Params, 103525.0 Ops, 0.000% oriMACs, 0.0 Ops, 0.000% ACs, 103525.0 Ops, 0.000% MACs, 100.000% Spike Rate, SpkStat: None)
)
Nops:  ['487296585189.0 Ops', '46994287490.95595 Ops', '33050434661.0 Ops']
Nparams:  13801612
Time cost: 0.5577648480733236 min
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
[05/11 19:27:30][INFO] test_net.py: 168: Test with config:
[05/11 19:27:30][INFO] test_net.py: 169: AUG:
  AA_TYPE: rand-m5-n2-mstd0.25
  COLOR_JITTER: 0.4
  ENABLE: True
  INTERPOLATION: bicubic
  NUM_SAMPLE: 2
  RE_COUNT: 1
  RE_MODE: pixel
  RE_PROB: 0.25
  RE_SPLIT: False
AVA:
  ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  BGR: False
  DETECTION_SCORE_THRESH: 0.9
  EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
  FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
  FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
  FULL_TEST_ON_VAL: False
  GROUNDTRUTH_FILE: ava_val_v2.2.csv
  IMG_PROC_BACKEND: cv2
  LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
  TEST_FORCE_FLIP: False
  TEST_LISTS: ['val.csv']
  TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
  TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
  TRAIN_LISTS: ['train.csv']
  TRAIN_PCA_JITTER_ONLY: True
  TRAIN_PREDICT_BOX_LISTS: []
  TRAIN_USE_COLOR_AUGMENTATION: False
BENCHMARK:
  LOG_PERIOD: 100
  NUM_EPOCHS: 5
  SHUFFLE: True
BN:
  NORM_TYPE: batchnorm
  NUM_BATCHES_PRECISE: 200
  NUM_SPLITS: 1
  NUM_SYNC_DEVICES: 1
  USE_PRECISE_STATS: False
  WEIGHT_DECAY: 0.0
DATA:
  DECODING_BACKEND: decord
  ENSEMBLE_METHOD: sum
  IMAGE_TEMPLATE: {:05d}.jpg
  INPUT_CHANNEL_NUM: [3]
  INV_UNIFORM_SAMPLE: False
  LABEL_PATH_TEMPLATE: somesomev1_rgb_{}_split.txt
  MEAN: [0.45, 0.45, 0.45]
  MULTI_LABEL: False
  NUM_FRAMES: 16
  PATH_LABEL_SEPARATOR:  
  PATH_PREFIX: /userhome/Datasets/ucf101/videos/
  PATH_TO_DATA_DIR: ./data_list/ucf101/split1
  PATH_TO_PRELOAD_IMDB: 
  RANDOM_FLIP: True
  REVERSE_INPUT_CHANNEL: False
  SAMPLING_RATE: 4
  STD: [0.225, 0.225, 0.225]
  TARGET_FPS: 30
  TEST_CROP_SIZE: 224
  TRAIN_CROP_SIZE: 224
  TRAIN_JITTER_ASPECT_RELATIVE: [0.75, 1.3333]
  TRAIN_JITTER_MOTION_SHIFT: False
  TRAIN_JITTER_SCALES: [224, 224]
  TRAIN_JITTER_SCALES_RELATIVE: [0.08, 1.0]
  TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
  TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
  USE_OFFSET_SAMPLING: True
DATA_LOADER:
  ENABLE_MULTI_THREAD_DECODE: False
  NUM_WORKERS: 8
  PIN_MEMORY: True
DEMO:
  BUFFER_SIZE: 0
  CLIP_VIS_SIZE: 10
  COMMON_CLASS_NAMES: ['watch (a person)', 'talk to (e.g., self, a person, a group)', 'listen to (a person)', 'touch (an object)', 'carry/hold (an object)', 'walk', 'sit', 'lie/sleep', 'bend/bow (at the waist)']
  COMMON_CLASS_THRES: 0.7
  DETECTRON2_CFG: COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml
  DETECTRON2_THRESH: 0.9
  DETECTRON2_WEIGHTS: detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl
  DISPLAY_HEIGHT: 0
  DISPLAY_WIDTH: 0
  ENABLE: False
  FPS: 30
  GT_BOXES: 
  INPUT_FORMAT: BGR
  INPUT_VIDEO: 
  LABEL_FILE_PATH: 
  NUM_CLIPS_SKIP: 0
  NUM_VIS_INSTANCES: 2
  OUTPUT_FILE: 
  OUTPUT_FPS: -1
  PREDS_BOXES: 
  SLOWMO: 1
  STARTING_SECOND: 900
  THREAD_ENABLE: False
  UNCOMMON_CLASS_THRES: 0.3
  VIS_MODE: thres
  WEBCAM: -1
DETECTION:
  ALIGNED: True
  ENABLE: False
  ROI_XFORM_RESOLUTION: 7
  SPATIAL_SCALE_FACTOR: 16
DIST_BACKEND: nccl
LOG_MODEL_INFO: True
LOG_PERIOD: 10
METASPIKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: [96, 192, 384, 480]
  KD: False
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
MIXUP:
  ALPHA: 0.8
  CUTMIX_ALPHA: 1.0
  ENABLE: True
  LABEL_SMOOTH_VALUE: 0.1
  PROB: 1.0
  SWITCH_PROB: 0.5
MODEL:
  ARCH: uniformer2d_psnn_lgf
  CHECKPOINT_NUM: [0, 0, 0, 0]
  DROPCONNECT_RATE: 0.0
  DROPOUT_RATE: 0.5
  FC_INIT_STD: 0.01
  HEAD_ACT: softmax
  LOSS_FUNC: soft_cross_entropy
  MODEL_NAME: Uniformer2d_psnn_lgf
  MULTI_PATHWAY_ARCH: ['slowfast']
  NUM_CLASSES: 101
  SINGLE_PATHWAY_ARCH: ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit', 'uniformer', 'spikingformer', 'spikingformer_cml', 'sew_resnet', 'uniformer_snn', 'uniformer_psnn', 'uniformer2d_snn', 'uniformer2d_psnn', 'uniformer2d_psnn_act', 'uniformer2d_psnn_norm', 'uniformer2d_psnn_bn', 'uniformer2d_psnn_try', 'uniformer2d_psnn_tri', 'uniformer2d_prsnn', 'rsew_resnet', 'uniformer2d_psnn_convBnLif', 'uniformer2d_psnn_head', 'uniformer2d_psnn_lgf', 'uniformer2d_psnn_qkf', 'uniformer2d_psnn_convqkf', 'uniformer2d_if_lgf', 'uniformer2d_psnn_lgfT', 'qkformer', 'uniformer3d_psnn', 'uniformer3d_psnn_lgf', 'sglformer', 'metaspikformer']
  USE_CHECKPOINT: False
MULTIGRID:
  BN_BASE_SIZE: 8
  DEFAULT_B: 0
  DEFAULT_S: 0
  DEFAULT_T: 0
  EPOCH_FACTOR: 1.5
  EVAL_FREQ: 3
  LONG_CYCLE: False
  LONG_CYCLE_FACTORS: [(0.25, 0.7071067811865476), (0.5, 0.7071067811865476), (0.5, 1), (1, 1)]
  LONG_CYCLE_SAMPLING_RATE: 0
  SHORT_CYCLE: False
  SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
MVIT:
  CLS_EMBED_ON: True
  DEPTH: 16
  DIM_MUL: []
  DROPOUT_RATE: 0.0
  DROPPATH_RATE: 0.1
  EMBED_DIM: 96
  HEAD_MUL: []
  MLP_RATIO: 4.0
  MODE: conv
  NORM: layernorm
  NORM_STEM: False
  NUM_HEADS: 1
  PATCH_2D: False
  PATCH_KERNEL: [3, 7, 7]
  PATCH_PADDING: [2, 4, 4]
  PATCH_STRIDE: [2, 4, 4]
  POOL_KVQ_KERNEL: None
  POOL_KV_STRIDE: []
  POOL_Q_STRIDE: []
  QKV_BIAS: True
  SEP_POS_EMBED: False
  ZERO_DECAY_POS_CLS: True
NONLOCAL:
  GROUP: [[1], [1], [1], [1]]
  INSTANTIATION: dot_product
  LOCATION: [[[]], [[]], [[]], [[]]]
  POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
NUM_GPUS: 1
NUM_SHARDS: 1
OUTPUT_DIR: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch
QKFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
RESNET:
  DEPTH: 50
  INPLACE_RELU: True
  NUM_BLOCK_TEMP_KERNEL: [[3], [4], [6], [3]]
  NUM_GROUPS: 1
  SPATIAL_DILATIONS: [[1], [1], [1], [1]]
  SPATIAL_STRIDES: [[1], [2], [2], [2]]
  STRIDE_1X1: False
  TRANS_FUNC: bottleneck_transform
  WIDTH_PER_GROUP: 64
  ZERO_INIT_FINAL_BN: False
RNG_SEED: 6666
SEWRESNET:
  CNF: ADD
  LAYERS: [3, 4, 23, 3]
  PRETRAIN_NAME: sew_resnet101_in1k
SHARD_ID: 0
SLOWFAST:
  ALPHA: 8
  BETA_INV: 8
  FUSION_CONV_CHANNEL_RATIO: 2
  FUSION_KERNEL_SZ: 5
SOLVER:
  BASE_LR: 0.006
  BASE_LR_SCALE_NUM_SHARDS: False
  CLIP_GRADIENT: 20
  COSINE_AFTER_WARMUP: True
  COSINE_END_LR: 1e-06
  DAMPENING: 0.0
  GAMMA: 0.1
  LRS: []
  LR_POLICY: cosine
  MAX_EPOCH: 600
  MOMENTUM: 0.9
  NESTEROV: True
  OPTIMIZING_METHOD: adamw
  STEPS: []
  STEP_SIZE: 1
  WARMUP_EPOCHS: 30.0
  WARMUP_FACTOR: 0.1
  WARMUP_START_LR: 1e-06
  WEIGHT_DECAY: 0.05
  ZERO_WD_1D_PARAM: True
SPIKINGFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
SPIKINGFORMER_CML:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: 8
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.2
  EMBED_DIM: 384
  MLP_RATIO: 4
  NUM_HEADS: 8
  PATCH_SIZE: 16
  PRETRAIN_NAME: None
  QKV_BIAS: False
  QKV_SCALE: None
  SR_RATIOS: 1
TENSORBOARD:
  CATEGORIES_PATH: 
  CLASS_NAMES_PATH: 
  CONFUSION_MATRIX:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
  ENABLE: True
  HISTOGRAM:
    ENABLE: False
    FIGSIZE: [8, 8]
    SUBSET_PATH: 
    TOPK: 10
  LOG_DIR: 
  MODEL_VIS:
    ACTIVATIONS: False
    COLORMAP: Pastel2
    ENABLE: False
    GRAD_CAM:
      COLORMAP: viridis
      ENABLE: True
      LAYER_LIST: []
      USE_TRUE_LABEL: False
    INPUT_VIDEO: False
    LAYER_LIST: []
    MODEL_WEIGHTS: False
    TOPK_PREDS: 1
  PREDICTIONS_PATH: 
  WRONG_PRED_VIS:
    ENABLE: False
    SUBSET_PATH: 
    TAG: Incorrectly classified videos.
TEST:
  BATCH_SIZE: 16
  CHECKPOINT_FILE_PATH: exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: True
  NUM_ENSEMBLE_VIEWS: 1
  NUM_SPATIAL_CROPS: 1
  SAVE_RESULTS_PATH: 
TRAIN:
  AUTO_RESUME: True
  BATCH_SIZE: 64
  CHECKPOINT_CLEAR_NAME_PATTERN: ()
  CHECKPOINT_EPOCH_RESET: False
  CHECKPOINT_FILE_PATH: 
  CHECKPOINT_INFLATE: False
  CHECKPOINT_PERIOD: 50
  CHECKPOINT_TYPE: pytorch
  DATASET: kinetics
  ENABLE: False
  EVAL_PERIOD: 5
UNIFORMER:
  ATTENTION_DROPOUT_RATE: 0
  DEPTH: [1, 1, 3, 1]
  DROPOUT_RATE: 0
  DROP_DEPTH_RATE: 0.0
  EMBED_DIM: [128, 256, 384, 512]
  HEAD_DIM: 64
  MLP_RATIO: 2
  PRETRAIN_NAME: 
  QKV_BIAS: True
  QKV_SCALE: None
  REPRESENTATION_SIZE: None
  SPLIT: False
  STAGE_TYPE: [0, 0, 1, 1]
  STD: False
  T: 1
X3D:
  BN_LIN5: False
  BOTTLENECK_FACTOR: 1.0
  CHANNELWISE_3x3x3: True
  DEPTH_FACTOR: 1.0
  DIM_C1: 12
  DIM_C5: 2048
  SCALE_RES2: False
  WIDTH_FACTOR: 1.0
[05/11 19:27:30][INFO] uniformer2d_psnn_lgf.py: 584: Use checkpoint: False
[05/11 19:27:30][INFO] uniformer2d_psnn_lgf.py: 585: Checkpoint number: [0, 0, 0, 0]
[05/11 19:27:32][INFO] misc.py: 191: Model:
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pos_drop): Dropout(p=0)
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
        (surrogate_function): ATan(alpha=2.0, spiking=True)
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm1): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
        (norm2): BatchNorm2d_eT(4096, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (norm1): BatchNorm1d_eT(18432, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True)
        (norm1): BatchNorm1d_eT(12288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True)
        (norm2): BatchNorm1d_eT(6144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
      (surrogate_function): ATan(alpha=2.0, spiking=True)
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m)
    (norm): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True)
        (norm1): BatchNorm1d_eT(24576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (proj): Linear(in_features=512, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (norm1): BatchNorm1d_eT(16384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
          (surrogate_function): ATan(alpha=2.0, spiking=True)
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (norm2): BatchNorm1d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m)
  (lpBN): BatchNorm2d_eT(8192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0
    (surrogate_function): ATan(alpha=2.0, spiking=True)
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (head): Linear(in_features=1024, out_features=101, bias=True)
)
[05/11 19:27:32][INFO] misc.py: 192: Params: 13,801,612
[05/11 19:27:32][INFO] misc.py: 193: Mem: 0.05342435836791992 MB
[05/11 19:27:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:27:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:27:35][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:27:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:27:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:27:35][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:27:35][INFO] misc.py: 195: Flops: 38.346109952 G
[05/11 19:27:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 35 time(s)
[05/11 19:27:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::batch_norm encountered 28 time(s)
[05/11 19:27:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::sigmoid encountered 39 time(s)
[05/11 19:27:36][WARNING] jit_analysis.py: 499: Unsupported operator prim::PythonOp.ParametricLIFNodeATGF encountered 39 time(s)
[05/11 19:27:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 12 time(s)
[05/11 19:27:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 16 time(s)
[05/11 19:27:36][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks1.0.act1.surrogate_function, blocks1.0.mlp.act1.surrogate_function, blocks1.0.mlp.act2.surrogate_function, blocks2.0.act1.surrogate_function, blocks2.0.mlp.act1.surrogate_function, blocks2.0.mlp.act2.surrogate_function, blocks3.0.attn.in_lif.surrogate_function, blocks3.0.attn.k_lif.surrogate_function, blocks3.0.attn.proj_lif.surrogate_function, blocks3.0.attn.q_lif.surrogate_function, blocks3.0.attn.v_lif.surrogate_function, blocks3.0.mlp.act1.surrogate_function, blocks3.0.mlp.act2.surrogate_function, blocks3.1.attn.in_lif.surrogate_function, blocks3.1.attn.k_lif.surrogate_function, blocks3.1.attn.proj_lif.surrogate_function, blocks3.1.attn.q_lif.surrogate_function, blocks3.1.attn.v_lif.surrogate_function, blocks3.1.mlp.act1.surrogate_function, blocks3.1.mlp.act2.surrogate_function, blocks3.2.attn.in_lif.surrogate_function, blocks3.2.attn.k_lif.surrogate_function, blocks3.2.attn.proj_lif.surrogate_function, blocks3.2.attn.q_lif.surrogate_function, blocks3.2.attn.v_lif.surrogate_function, blocks3.2.mlp.act1.surrogate_function, blocks3.2.mlp.act2.surrogate_function, blocks4.0.attn.in_lif.surrogate_function, blocks4.0.attn.k_lif.surrogate_function, blocks4.0.attn.proj_lif.surrogate_function, blocks4.0.attn.q_lif.surrogate_function, blocks4.0.attn.v_lif.surrogate_function, blocks4.0.mlp.act1.surrogate_function, blocks4.0.mlp.act2.surrogate_function, lif_bf_head.surrogate_function, lplif.surrogate_function, patch_embed2.in_lif.surrogate_function, patch_embed3.in_lif.surrogate_function, patch_embed4.in_lif.surrogate_function, pos_drop
[05/11 19:27:36][INFO] misc.py: 203: Activations: 103.562341 M
[05/11 19:27:36][INFO] misc.py: 210: nvidia-smi
Sat May 11 19:27:36 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1B:00.0 Off |                    0 |
| N/A   37C    P0    27W /  70W |   3420MiB / 15109MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
+-----------------------------------------------------------------------------+
[05/11 19:27:36][INFO] checkpoint.py: 213: Loading network weights from exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/checkpoints/best_Valtop1Err_checkpoint.pyth.
[05/11 19:27:36][INFO] kinetics.py:  76: Constructing Kinetics test...
[05/11 19:27:36][INFO] kinetics.py: 123: Constructing kinetics dataloader (size: 3783) from ./data_list/ucf101/split1/test.csv
[05/11 19:27:36][INFO] test_net.py: 180: Testing model for 237 iterations
[05/11 19:27:36][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir exp/uniformer2d_psnn_tri57_base45_s16b_lgf_lplif_hdlif_ucf101_scratch/runs-kinetics`
Warning: module BatchNorm2d_eT is treated as a zero-op.
Warning: module SpeicalPatchEmbed is treated as a zero-op.
Warning: module Dropout is treated as a zero-op.
Warning: module ATan is treated as a zero-op.
Warning: module Identity is treated as a zero-op.
Warning: module CMlp is treated as a zero-op.
Warning: module CBlock is treated as a zero-op.
Warning: module PatchEmbed is treated as a zero-op.
Warning: module BatchNorm1d_eT is treated as a zero-op.
Warning: module Attention is treated as a zero-op.
Warning: module Mlp is treated as a zero-op.
Warning: module SABlock is treated as a zero-op.
Warning: module Uniformer2d_psnn_lgf is treated as a zero-op.
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_functional_video.py:5: UserWarning: The _functional_video module is deprecated. Please use the functional module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/_transforms_video.py:25: UserWarning: The _transforms_video module is deprecated. Please use the transforms module instead.
  warnings.warn(
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
/opt/conda/lib/python3.8/site-packages/spikingjelly-0.0.0.0.14-py3.8.egg/spikingjelly/activation_based/cuda_utils.py:170: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  Acc@1: 87.5000 (80.8750)  Acc@5: 100.0000 (94.1250)
  Acc@1: 62.5000 (80.6250)  Acc@5: 81.2500 (94.0938)
  Acc@1: 57.1429 (80.7296)  Acc@5: 85.7143 (94.1052)
Uniformer2d_psnn_lgf(
  (patch_embed1): SpeicalPatchEmbed(
    (proj): Conv2d(3, 128, kernel_size=(6, 6), stride=(4, 4), padding=(1, 1), step_mode=m, 13952, 0.101% Params, 5613768233.008723 Ops, 1.149% oriMACs, 0.0 Ops, 0.000% ACs, 5613768233.008723 Ops, 16.945% MACs, 100.000% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (pos_drop): Dropout()
  (blocks1): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5784944295883179, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 16.678% Spike Rate, SpkStat: None
        (surrogate_function): ATan()
      )
      (conv1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 16512, 0.120% Params, 6643817450.074544 Ops, 1.360% oriMACs, 1108025712.1058683 Ops, 2.337% ACs, 0.0 Ops, 0.000% MACs, 16.678% Spike Rate, SpkStat: None)
      (attn): Conv2d(128, 128, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=128, step_mode=m, 3328, 0.024% Params, 1339063982.185567 Ops, 0.274% oriMACs, 0.0 Ops, 0.000% ACs, 1339063982.185567 Ops, 4.042% MACs, 100.000% Spike Rate, SpkStat: None)
      (conv2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 16512, 0.120% Params, 6643817450.074544 Ops, 1.360% oriMACs, 0.0 Ops, 0.000% ACs, 6643817450.074544 Ops, 20.054% MACs, 100.000% Spike Rate, SpkStat: None)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT()
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.9701817035675049, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 15.669% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 33024, 0.239% Params, 26575269800.298176 Ops, 5.441% oriMACs, 4163955625.4242663 Ops, 8.781% ACs, 0.0 Ops, 0.000% MACs, 15.669% Spike Rate, SpkStat: None)
        (norm1): BatchNorm2d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.538673162460327, 1, 0.000% Params, 12845056.0 Ops, 0.003% oriMACs, 12845056.0 Ops, 0.027% ACs, 0.0 Ops, 0.000% MACs, 15.548% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 32896, 0.238% Params, 13236132439.295797 Ops, 2.710% oriMACs, 2057939621.3917525 Ops, 4.340% ACs, 0.0 Ops, 0.000% MACs, 15.548% Spike Rate, SpkStat: None)
        (norm2): BatchNorm2d_eT()
      )
    )
  )
  (patch_embed2): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.2462283372879028, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 18.037% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d(128, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m, 524544, 3.801% Params, 105528542288.39334 Ops, 21.606% oriMACs, 19034624178.415344 Ops, 40.142% ACs, 0.0 Ops, 0.000% MACs, 18.037% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (blocks2): ModuleList(
    (0): CBlock(
      (act1): ParametricLIFNode(
        v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.169824481010437, 1, 0.000% Params, 3211264.0 Ops, 0.001% oriMACs, 3211264.0 Ops, 0.007% ACs, 0.0 Ops, 0.000% MACs, 11.906% Spike Rate, SpkStat: None
        (surrogate_function): ATan()
      )
      (conv1): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 65792, 0.477% Params, 13236132439.295797 Ops, 2.710% oriMACs, 1575915466.2820513 Ops, 3.323% ACs, 0.0 Ops, 0.000% MACs, 11.906% Spike Rate, SpkStat: None)
      (attn): Conv2d(256, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=256, step_mode=m, 6656, 0.048% Params, 1339063982.185567 Ops, 0.274% oriMACs, 0.0 Ops, 0.000% ACs, 1339063982.185567 Ops, 4.042% MACs, 100.000% Spike Rate, SpkStat: None)
      (conv2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 65792, 0.477% Params, 13236132439.295797 Ops, 2.710% oriMACs, 0.0 Ops, 0.000% ACs, 13236132439.295797 Ops, 39.953% MACs, 100.000% Spike Rate, SpkStat: None)
      (drop_path): Identity()
      (norm2): BatchNorm2d_eT()
      (mlp): CMlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.0328818559646606, 1, 0.000% Params, 3211264.0 Ops, 0.001% oriMACs, 3211264.0 Ops, 0.007% ACs, 0.0 Ops, 0.000% MACs, 12.767% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 131584, 0.953% Params, 52944529757.18319 Ops, 10.840% oriMACs, 6759641399.33862 Ops, 14.255% ACs, 0.0 Ops, 0.000% MACs, 12.767% Spike Rate, SpkStat: None)
        (norm1): BatchNorm2d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.697751522064209, 1, 0.000% Params, 6422528.0 Ops, 0.001% oriMACs, 6422528.0 Ops, 0.014% ACs, 0.0 Ops, 0.000% MACs, 7.744% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 131328, 0.952% Params, 26420762417.738304 Ops, 5.409% oriMACs, 2046074215.343874 Ops, 4.315% ACs, 0.0 Ops, 0.000% MACs, 7.744% Spike Rate, SpkStat: None)
        (norm2): BatchNorm2d_eT()
      )
    )
  )
  (patch_embed3): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5027964115142822, 1, 0.000% Params, 3211264.0 Ops, 0.001% oriMACs, 3211264.0 Ops, 0.007% ACs, 0.0 Ops, 0.000% MACs, 6.402% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d(256, 384, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m, 1573248, 11.399% Params, 118690639940.21252 Ops, 24.301% oriMACs, 7598166244.423052 Ops, 16.024% ACs, 0.0 Ops, 0.000% MACs, 6.402% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (blocks3): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.51208233833313, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 6.576% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True, 443520, 3.214% Params, 1387267202.740682 Ops, 0.284% oriMACs, 91229453.22546451 Ops, 0.192% ACs, 0.0 Ops, 0.000% MACs, 6.576% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0040385723114014, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 9.329% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.321223735809326, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 8.078% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.1636204719543457, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 11.086% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.178424835205078, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 21.754% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=384, out_features=384, bias=True, 147840, 1.071% Params, 462422400.9135607 Ops, 0.095% oriMACs, 100583830.14192054 Ops, 0.212% ACs, 0.0 Ops, 0.000% MACs, 21.754% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.0380210876464844, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 14.548% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True, 295680, 2.142% Params, 924844801.8271214 Ops, 0.189% oriMACs, 134554976.07758653 Ops, 0.284% ACs, 0.0 Ops, 0.000% MACs, 14.548% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0244860649108887, 1, 0.000% Params, 2408448.0 Ops, 0.000% oriMACs, 2408448.0 Ops, 0.005% ACs, 0.0 Ops, 0.000% MACs, 2.538% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True, 295296, 2.140% Params, 924844416.9135606 Ops, 0.189% oriMACs, 23471110.89407891 Ops, 0.049% ACs, 0.0 Ops, 0.000% MACs, 2.538% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
    (1): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.622936248779297, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 5.984% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True, 443520, 3.214% Params, 1387267202.740682 Ops, 0.284% oriMACs, 83021697.72161503 Ops, 0.175% ACs, 0.0 Ops, 0.000% MACs, 5.984% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.214975357055664, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 11.808% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.039510726928711, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 9.952% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.3648018836975098, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 8.508% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.9816348552703857, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 22.417% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=384, out_features=384, bias=True, 147840, 1.071% Params, 462422400.9135607 Ops, 0.095% oriMACs, 103658587.45956305 Ops, 0.219% ACs, 0.0 Ops, 0.000% MACs, 22.417% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5850307941436768, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 10.998% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True, 295680, 2.142% Params, 924844801.8271214 Ops, 0.189% oriMACs, 101718846.08361964 Ops, 0.215% ACs, 0.0 Ops, 0.000% MACs, 10.998% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.5154521465301514, 1, 0.000% Params, 2408448.0 Ops, 0.000% oriMACs, 2408448.0 Ops, 0.005% ACs, 0.0 Ops, 0.000% MACs, 4.058% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True, 295296, 2.140% Params, 924844416.9135606 Ops, 0.189% oriMACs, 37531106.38196171 Ops, 0.079% ACs, 0.0 Ops, 0.000% MACs, 4.058% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
    (2): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.248232364654541, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 8.369% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=384, out_features=1152, bias=True, 443520, 3.214% Params, 1387267202.740682 Ops, 0.284% oriMACs, 116103664.58230568 Ops, 0.245% ACs, 0.0 Ops, 0.000% MACs, 8.369% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.153169631958008, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 22.295% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.14504337310791, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 9.091% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.923473596572876, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 11.585% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.229710578918457, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 34.611% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=384, out_features=384, bias=True, 147840, 1.071% Params, 462422400.9135607 Ops, 0.095% oriMACs, 160039823.53510436 Ops, 0.338% ACs, 0.0 Ops, 0.000% MACs, 34.611% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.4227283000946045, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 4.787% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=384, out_features=768, bias=True, 295680, 2.142% Params, 924844801.8271214 Ops, 0.189% oriMACs, 44273334.05745611 Ops, 0.093% ACs, 0.0 Ops, 0.000% MACs, 4.787% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.283605575561523, 1, 0.000% Params, 2408448.0 Ops, 0.000% oriMACs, 2408448.0 Ops, 0.005% ACs, 0.0 Ops, 0.000% MACs, 5.070% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=768, out_features=384, bias=True, 295296, 2.140% Params, 924844416.9135606 Ops, 0.189% oriMACs, 46889255.1395004 Ops, 0.099% ACs, 0.0 Ops, 0.000% MACs, 5.070% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
  )
  (patch_embed4): PatchEmbed(
    (in_lif): ParametricLIFNode(
      v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.373702049255371, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 2.371% Spike Rate, SpkStat: None
      (surrogate_function): ATan()
    )
    (proj): Conv2d(384, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1), step_mode=m, 3146240, 22.796% Params, 79120655485.86836 Ops, 16.199% oriMACs, 1875935687.268702 Ops, 3.956% ACs, 0.0 Ops, 0.000% MACs, 2.371% Spike Rate, SpkStat: None)
    (norm): BatchNorm2d_eT()
  )
  (blocks4): ModuleList(
    (0): SABlock(
      (attn): Attention(
        (in_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.571432113647461, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 5.372% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (qkv): Linear(in_features=512, out_features=1536, bias=True, 787968, 5.709% Params, 616564227.6542426 Ops, 0.126% oriMACs, 33123116.07592725 Ops, 0.070% ACs, 0.0 Ops, 0.000% MACs, 5.372% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (q_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=1.8827295303344727, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 13.785% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (k_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.1508498191833496, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 7.714% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (v_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.235987663269043, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 7.275% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj_lif): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.0004072189331055, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 4.945% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (proj): Linear(in_features=512, out_features=512, bias=True, 262656, 1.903% Params, 205521409.21808088 Ops, 0.042% oriMACs, 10164629.749888675 Ops, 0.021% ACs, 0.0 Ops, 0.000% MACs, 4.945% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
      (drop_path): Identity()
      (mlp): Mlp(
        (act1): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.3670759201049805, 1, 0.000% Params, 401408.0 Ops, 0.000% oriMACs, 401408.0 Ops, 0.001% ACs, 0.0 Ops, 0.000% MACs, 3.658% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc1): Linear(in_features=512, out_features=1024, bias=True, 525312, 3.806% Params, 411042818.43616176 Ops, 0.084% oriMACs, 15034479.645650793 Ops, 0.032% ACs, 0.0 Ops, 0.000% MACs, 3.658% Spike Rate, SpkStat: None)
        (norm1): BatchNorm1d_eT()
        (act2): ParametricLIFNode(
          v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=4.4031219482421875, 1, 0.000% Params, 802816.0 Ops, 0.000% oriMACs, 802816.0 Ops, 0.002% ACs, 0.0 Ops, 0.000% MACs, 2.163% Spike Rate, SpkStat: None
          (surrogate_function): ATan()
        )
        (fc2): Linear(in_features=1024, out_features=512, bias=True, 524800, 3.802% Params, 411042305.2180809 Ops, 0.084% oriMACs, 8891682.53212236 Ops, 0.019% ACs, 0.0 Ops, 0.000% MACs, 2.163% Spike Rate, SpkStat: None)
        (norm2): BatchNorm1d_eT()
      )
    )
  )
  (lplif): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=2.864428997039795, 1, 0.000% Params, 1204224.0 Ops, 0.000% oriMACs, 1204224.0 Ops, 0.003% ACs, 0.0 Ops, 0.000% MACs, 5.649% Spike Rate, SpkStat: None
    (surrogate_function): ATan()
  )
  (lpDWConv): Conv2d(384, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=384, step_mode=m, 3840, 0.028% Params, 72425335.57494052 Ops, 0.015% oriMACs, 4091182.9486766453 Ops, 0.009% ACs, 0.0 Ops, 0.000% MACs, 5.649% Spike Rate, SpkStat: None)
  (lpPWConv): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1), step_mode=m, 197120, 1.428% Params, 4957111857.129263 Ops, 1.015% oriMACs, 0.0 Ops, 0.000% ACs, 4957111857.129263 Ops, 14.963% MACs, 100.000% Spike Rate, SpkStat: None)
  (lpBN): BatchNorm2d_eT()
  (lif_bf_head): ParametricLIFNode(
    v_threshold=1.0, v_reset=0.0, detach_reset=True, step_mode=m, backend=cupy, tau=3.526439666748047, 1, 0.000% Params, 802816.0 Ops, 0.000% oriMACs, 802816.0 Ops, 0.002% ACs, 0.0 Ops, 0.000% MACs, 3.771% Spike Rate, SpkStat: None
    (surrogate_function): ATan()
  )
  (dwconv_bf_head): Conv3d(1024, 1024, kernel_size=(16, 7, 7), stride=(1, 1, 1), groups=512, 1606656, 11.641% Params, 1606656.0 Ops, 0.000% oriMACs, 60569.257941204436 Ops, 0.000% ACs, 0.0 Ops, 0.000% MACs, 3.771% Spike Rate, SpkStat: None)
  (dwconv_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, 2048, 0.015% Params, 2048.0 Ops, 0.000% oriMACs, 0.0 Ops, 0.000% ACs, 2048.0 Ops, 0.000% MACs, 100.000% Spike Rate, SpkStat: None)
  (head): Linear(in_features=1024, out_features=101, bias=True, 103525, 0.750% Params, 103525.0 Ops, 0.000% oriMACs, 0.0 Ops, 0.000% ACs, 103525.0 Ops, 0.000% MACs, 100.000% Spike Rate, SpkStat: None)
)
Nops:  ['488425377618.52576 Ops', '47418212359.50391 Ops', '33129063516.87946 Ops']
Nparams:  13801612
Time cost: 6.679412070910136 min
